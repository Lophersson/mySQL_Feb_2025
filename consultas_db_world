SELECT 
    country.Name AS Country,
    COUNT(city.ID) AS CityCount
FROM 
    country
LEFT JOIN 
    city ON country.Code = city.CountryCode
GROUP BY 
    country.Name
ORDER BY 
    CityCount DESC;
---
SELECT 
    country.Name AS paises,
    COUNT(city.ID) AS numero_ciudades
FROM 
    country
LEFT JOIN 
    city ON country.Code = city.CountryCode
GROUP BY 
    country.Name
ORDER BY 
    numero_ciudades DESC;
---
SELECT 
    country.Name AS país,
    FORMAT(ROUND(AVG(city.Population)), 0) AS población_media_ciudades
FROM 
    country
LEFT JOIN 
    city ON country.Code = city.CountryCode
GROUP BY 
    country.Name
ORDER BY 
    AVG(city.Population) DESC;
---
SELECT 
    country.Name AS países,
    FORMAT(ROUND(AVG(city.Population)), 0) AS población_media_ciudades
FROM 
    country
JOIN 
    city ON country.Code = city.CountryCode
WHERE 
    city.Population > 500000
GROUP BY 
    country.Name
ORDER BY 
    AVG(city.Population) DESC;
---
SELECT 
    country.Name AS País,
    COUNT(city.ID) AS Cantidad_Ciudades
FROM 
    country
JOIN 
    city ON country.Code = city.CountryCode
GROUP BY 
    country.Name
HAVING 
    COUNT(city.ID) >= 5
ORDER BY 
    Cantidad_Ciudades DESC;
---
SELECT 
    country.Name AS País,
    city.Name AS Ciudad,
    FORMAT(city.Population, 0) AS Población
FROM 
    country
JOIN 
    city ON country.Code = city.CountryCode
WHERE 
    country.Name = 'Spain'
ORDER BY 
    city.Population DESC;
---
SELECT 
    country.Name AS País,
    city.Name AS Ciudad
FROM 
    country
JOIN 
    city ON country.Code = city.CountryCode
WHERE 
    country.Name = 'Spain'
ORDER BY 
    city.Name;
---
SELECT 
    country.Name AS País,
    COUNT(city.ID) AS Cantidad_Ciudades
FROM 
    country
JOIN 
    city ON country.Code = city.CountryCode
GROUP BY 
    country.Name
HAVING 
    COUNT(city.ID) >= 5
ORDER BY 
    Cantidad_Ciudades DESC;
---
